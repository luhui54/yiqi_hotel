import{_ as k,u as x,C as V,ai as y,r as S,d as i,o as R,E,e as t,w as n,i as T,R as B,f as C,M as F,K as u}from"./index-98ff7959.js";import{u as N}from"./user-194456a1.js";const j=["src"],M={__name:"UploadImg",props:{images:{type:String,default:""},limit:{type:Number,default:9}},emits:["handleUpload","update:images"],setup(p,{emit:_}){const g=N(),f=x(),d=p,o=V({action:"https://www.markerhub.com/common/uploadImg",headers:{userToken:g.userToken||null,adminToken:f.adminToken||null},pics:[],dialogImageUrl:"",dialogVisible:!1});y(()=>d.images,(a,e)=>{a?o.pics=a.split(";").filter(l=>l&&l.trim()!=="").map(l=>({url:l})):o.pics=[]},{immediate:!0});const r=_,m=S(),h=(a,e,l)=>{a.code===200?(e.url=a.data,c()):(u.error(a.msg),m.value.handleRemove(e))},v=(a,e)=>{c()},U=a=>{o.dialogImageUrl=a.url,o.dialogVisible=!0},b=()=>{u.error("超出数量限制")},c=()=>{const a=o.pics.filter(e=>e.url&&e.url.trim()!=="").map(e=>e.url).join(";");r("handleUpload",a),r("update:images",a)};return(a,e)=>{const l=i("el-icon"),w=i("el-upload"),I=i("el-dialog");return R(),E(F,null,[t(w,{ref_key:"uploadRef",ref:m,"file-list":o.pics,"onUpdate:fileList":e[0]||(e[0]=s=>o.pics=s),action:o.action,headers:o.headers,name:"image","list-type":"picture-card","on-preview":U,"on-remove":v,"on-success":h,"on-exceed":b,limit:d.limit},{default:n(()=>[t(l,null,{default:n(()=>[t(T(B))]),_:1})]),_:1},8,["file-list","action","headers","limit"]),t(I,{modelValue:o.dialogVisible,"onUpdate:modelValue":e[1]||(e[1]=s=>o.dialogVisible=s),"append-to-body":""},{default:n(()=>[C("img",{"w-full":"",src:o.dialogImageUrl,alt:"Preview Image",style:{"max-width":"100%","max-height":"80vh","object-fit":"contain"}},null,8,j)]),_:1},8,["modelValue"])],64)}}},K=k(M,[["__scopeId","data-v-b915dea8"]]);export{K as U};
