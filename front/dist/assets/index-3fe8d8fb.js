import{J as w,_ as z,r as v,C as R,d as i,o as h,a as I,w as a,e,E as F,M as A,N as E,h as _,K as P,A as H,B as $,f as N,L as T}from"./index-98ff7959.js";import{U as S}from"./UploadImg-bd809d4c.js";import"./user-194456a1.js";function M(s){return w({url:"/admin/hotel/page",method:"get",params:s})}function j(s){return w({url:"/admin/hotel/info/"+s,method:"get"})}function L(s){return w({url:"/admin/hotel/save",method:"post",data:s})}function G(s){return w({url:"/admin/hotel/delete",method:"post",data:s})}const J=s=>(H("data-v-f1ed0708"),s=s(),$(),s),K=J(()=>N("div",{class:"form-tip"},"上传多张酒店图片，最多6张",-1)),O={__name:"edit",emits:["handleClose"],setup(s,{expose:p,emit:c}){const f=v(!1),b=v([]),l=v({});p({init:n=>{f.value=!0,n?j(n).then(t=>{l.value=t.data.hotel,l.value.image||(l.value.image=""),l.value.images||(l.value.images=""),b.value=t.data.rankDict}):l.value={image:"",images:""}}});const y=R({title:[{required:!0,message:"此项是必填项",trigger:"blur"}],brand:[{required:!0,message:"此项是必填项",trigger:"blur"}],image:[{required:!0,message:"此项是必填项",trigger:"blur"}],city:[{required:!0,message:"此项是必填项",trigger:"blur"}],tel:[{required:!0,message:"此项是必填项",trigger:"blur"}],location:[{required:!0,message:"此项是必填项",trigger:"blur"}],introduction:[{required:!0,message:"此项是必填项",trigger:"blur"}],score:[{required:!0,message:"此项是必填项",trigger:"blur"}],rank:[{required:!0,message:"此项是必填项",trigger:"blur"}],minPrice:[{required:!0,message:"此项是必填项",trigger:"blur"}]}),k=c,V=n=>{f.value=!1,k("handleClose",n)},C=v(),u=()=>{C.value.validate((n,t)=>{n&&(l.value.image&&Array.isArray(l.value.image)&&(l.value.image=l.value.image.join(";")),l.value.images&&Array.isArray(l.value.images)&&(l.value.images=l.value.images.join(";")),L(l.value).then(d=>{P.success("操作成功"),V(!0)}))})};return(n,t)=>{const d=i("el-input"),r=i("el-form-item"),U=i("el-rate"),m=i("el-option"),q=i("el-select"),x=i("el-button"),B=i("el-form"),g=i("el-drawer");return h(),I(g,{modelValue:f.value,"onUpdate:modelValue":t[11]||(t[11]=o=>f.value=o),title:"新增或编辑",size:"650px","destroy-on-close":!0},{default:a(()=>[e(B,{ref_key:"formRef",ref:C,style:{"max-width":"600px"},model:l.value,rules:y,"label-width":"auto"},{default:a(()=>[e(r,{label:"酒店名称",prop:"title"},{default:a(()=>[e(d,{modelValue:l.value.title,"onUpdate:modelValue":t[0]||(t[0]=o=>l.value.title=o)},null,8,["modelValue"])]),_:1}),e(r,{label:"品牌",prop:"brand"},{default:a(()=>[e(d,{modelValue:l.value.brand,"onUpdate:modelValue":t[1]||(t[1]=o=>l.value.brand=o)},null,8,["modelValue"])]),_:1}),e(r,{label:"封面图片",prop:"image"},{default:a(()=>[e(S,{images:l.value.image,"onUpdate:images":t[2]||(t[2]=o=>l.value.image=o),limit:1},null,8,["images"])]),_:1}),e(r,{label:"所在城市",prop:"city"},{default:a(()=>[e(d,{modelValue:l.value.city,"onUpdate:modelValue":t[3]||(t[3]=o=>l.value.city=o)},null,8,["modelValue"])]),_:1}),e(r,{label:"酒店图集",prop:"images"},{default:a(()=>[e(S,{images:l.value.images,"onUpdate:images":t[4]||(t[4]=o=>l.value.images=o),limit:6},null,8,["images"]),K]),_:1}),e(r,{label:"电话",prop:"tel"},{default:a(()=>[e(d,{modelValue:l.value.tel,"onUpdate:modelValue":t[5]||(t[5]=o=>l.value.tel=o)},null,8,["modelValue"])]),_:1}),e(r,{label:"所在地址",prop:"location"},{default:a(()=>[e(d,{modelValue:l.value.location,"onUpdate:modelValue":t[6]||(t[6]=o=>l.value.location=o)},null,8,["modelValue"])]),_:1}),e(r,{label:"简介",prop:"introduction"},{default:a(()=>[e(d,{modelValue:l.value.introduction,"onUpdate:modelValue":t[7]||(t[7]=o=>l.value.introduction=o),type:"textarea",rows:"5"},null,8,["modelValue"])]),_:1}),e(r,{label:"评分",prop:"score"},{default:a(()=>[e(U,{modelValue:l.value.score,"onUpdate:modelValue":t[8]||(t[8]=o=>l.value.score=o)},null,8,["modelValue"])]),_:1}),e(r,{label:"等级",prop:"hotelRank"},{default:a(()=>[e(q,{modelValue:l.value.hotelRank,"onUpdate:modelValue":t[9]||(t[9]=o=>l.value.hotelRank=o),placeholder:"请选择星级"},{default:a(()=>[(h(!0),F(A,null,E(b.value,o=>(h(),I(m,{key:o.key,label:o.value,value:o.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(r,{label:"最低价",prop:"minPrice"},{default:a(()=>[e(d,{modelValue:l.value.minPrice,"onUpdate:modelValue":t[10]||(t[10]=o=>l.value.minPrice=o)},null,8,["modelValue"])]),_:1}),e(r,null,{default:a(()=>[e(x,{type:"primary",onClick:u},{default:a(()=>[_("提交")]),_:1}),e(x,{onClick:V},{default:a(()=>[_("关闭")]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])}}},Q=z(O,[["__scopeId","data-v-f1ed0708"]]),Z={__name:"index",setup(s){const p=R({searchForm:{},pageData:[],page:{current:1,size:10},total:0}),c=()=>{M({...p.page,...p.searchForm}).then(u=>{p.pageData=u.data.records,p.total=u.data.total})};c();const f=u=>{p.page.current=u,c()},b=v(),l=u=>{b.value.init(u)},D=u=>{u&&c()},y=v(!0);let k=[];const V=u=>{const n=[];u?n.push(u):n.push(...k),T.confirm("确认删除该记录吗？","警告",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(()=>{G(n).then(t=>{P.success("删除成功"),c()})})},C=u=>{y.value=u.length===0,k=u.map(n=>n.id)};return(u,n)=>{const t=i("el-input"),d=i("el-form-item"),r=i("el-button"),U=i("el-form"),m=i("el-table-column"),q=i("el-image"),x=i("el-table"),B=i("el-pagination");return h(),F("div",null,[e(U,{"label-width":"auto",inline:!0},{default:a(()=>[e(d,null,{default:a(()=>[e(t,{modelValue:p.searchForm.title,"onUpdate:modelValue":n[0]||(n[0]=g=>p.searchForm.title=g),placeholder:"酒店名称"},null,8,["modelValue"])]),_:1}),e(d,null,{default:a(()=>[e(r,{onClick:c},{default:a(()=>[_("搜索")]),_:1})]),_:1}),e(d,null,{default:a(()=>[e(r,{type:"primary",onClick:n[1]||(n[1]=g=>l(null))},{default:a(()=>[_("新增")]),_:1})]),_:1}),e(d,null,{default:a(()=>[e(r,{type:"danger",onClick:n[2]||(n[2]=g=>V(null)),disabled:y.value},{default:a(()=>[_("批量删除")]),_:1},8,["disabled"])]),_:1})]),_:1}),e(x,{data:p.pageData,border:"",style:{width:"100%"},onSelectionChange:C},{default:a(()=>[e(m,{type:"selection",width:"55"}),e(m,{prop:"id",label:"ID"}),e(m,{prop:"title",label:"酒店名称"}),e(m,{prop:"brand",label:"品牌"}),e(m,{prop:"image",label:"图片"},{default:a(g=>[e(q,{src:g.row.image,style:{height:"50px"}},null,8,["src"])]),_:1}),e(m,{prop:"city",label:"所在城市"}),e(m,{prop:"score",label:"评分"}),e(m,{prop:"rankStr",label:"等级"}),e(m,{prop:"minPrice",label:"最低价"}),e(m,{prop:"createTime",label:"创建时间"}),e(m,{label:"操作"},{default:a(g=>[e(r,{type:"text",onClick:o=>l(g.row.id)},{default:a(()=>[_("编辑")]),_:2},1032,["onClick"]),e(r,{type:"text",onClick:o=>V(g.row.id)},{default:a(()=>[_("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),e(B,{style:{"margin-top":"16px"},background:"",layout:"total, prev, pager, next","page-size":p.page.size,total:p.total,onCurrentChange:f},null,8,["page-size","total"]),e(Q,{ref_key:"editRef",ref:b,onHandleClose:D},null,512)])}}};export{Z as default};
