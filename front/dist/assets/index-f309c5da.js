import{I as T,S as D,G as z,D as A}from"./roomType-ad4bec6d.js";import{U as q}from"./UploadImg-bd809d4c.js";import{_ as E,r as V,C as U,d as r,o as B,a as F,w as t,e,h as g,K as I,A as H,B as $,f as R,E as N,L as j}from"./index-98ff7959.js";import"./user-194456a1.js";const G=c=>(H("data-v-cbdd8bb5"),c=c(),$(),c),M=G(()=>R("div",{class:"form-tip"},"上传多张房间图片，最多6张",-1)),K={__name:"edit",emits:["handleClose"],setup(c,{expose:i,emit:m}){const _=V(!1),l=V({});i({init:o=>{_.value=!0,o?T(o).then(a=>{l.value=a.data,l.value.image||(l.value.image=""),l.value.images||(l.value.images="")}):l.value={image:"",images:""}}});const w=U({id:[{required:!0,message:"此项是必填项",trigger:"blur"}],hotelId:[{required:!0,message:"此项是必填项",trigger:"blur"}],name:[{required:!0,message:"此项是必填项",trigger:"blur"}],image:[{required:!0,message:"此项是必填项",trigger:"blur"}],price:[{required:!0,message:"此项是必填项",trigger:"blur"}],bed:[{required:!0,message:"此项是必填项",trigger:"blur"}],quantity:[{required:!0,message:"此项是必填项",trigger:"blur"}],createTime:[{required:!0,message:"此项是必填项",trigger:"blur"}]}),y=m,v=o=>{_.value=!1,y("handleClose",o)},b=V(),k=()=>{b.value.validate((o,a)=>{o&&(l.value.image&&Array.isArray(l.value.image)&&(l.value.image=l.value.image.join(";")),l.value.images&&Array.isArray(l.value.images)&&(l.value.images=l.value.images.join(";")),D(l.value).then(s=>{I.success("操作成功"),v(!0)}))})};return(o,a)=>{const s=r("el-input"),u=r("el-form-item"),p=r("el-input-number"),C=r("el-button"),d=r("el-form"),h=r("el-drawer");return B(),F(h,{modelValue:_.value,"onUpdate:modelValue":a[9]||(a[9]=n=>_.value=n),title:"新增或编辑",size:"650px","destroy-on-close":!0},{default:t(()=>[e(d,{ref_key:"formRef",ref:b,style:{"max-width":"600px"},model:l.value,rules:w,"label-width":"auto"},{default:t(()=>[e(u,{label:"房间名称",prop:"name"},{default:t(()=>[e(s,{modelValue:l.value.name,"onUpdate:modelValue":a[0]||(a[0]=n=>l.value.name=n)},null,8,["modelValue"])]),_:1}),e(u,{label:"封面图片",prop:"image"},{default:t(()=>[e(q,{images:l.value.image,"onUpdate:images":a[1]||(a[1]=n=>l.value.image=n),limit:1},null,8,["images"])]),_:1}),e(u,{label:"房间图集",prop:"images"},{default:t(()=>[e(q,{images:l.value.images,"onUpdate:images":a[2]||(a[2]=n=>l.value.images=n),limit:6},null,8,["images"]),M]),_:1}),e(u,{label:"价格",prop:"price"},{default:t(()=>[e(s,{modelValue:l.value.price,"onUpdate:modelValue":a[3]||(a[3]=n=>l.value.price=n)},null,8,["modelValue"])]),_:1}),e(u,{label:"面积",prop:"area"},{default:t(()=>[e(s,{modelValue:l.value.area,"onUpdate:modelValue":a[4]||(a[4]=n=>l.value.area=n)},null,8,["modelValue"])]),_:1}),e(u,{label:"标签",prop:"tags"},{default:t(()=>[e(s,{modelValue:l.value.tags,"onUpdate:modelValue":a[5]||(a[5]=n=>l.value.tags=n),placeholder:"多个标签用英文分号隔开"},null,8,["modelValue"])]),_:1}),e(u,{label:"床位",prop:"bed"},{default:t(()=>[e(s,{modelValue:l.value.bed,"onUpdate:modelValue":a[6]||(a[6]=n=>l.value.bed=n)},null,8,["modelValue"])]),_:1}),e(u,{label:"说明",prop:"instruction"},{default:t(()=>[e(s,{modelValue:l.value.instruction,"onUpdate:modelValue":a[7]||(a[7]=n=>l.value.instruction=n),type:"textarea",rows:"5"},null,8,["modelValue"])]),_:1}),e(u,{label:"剩余数量",prop:"quantity"},{default:t(()=>[e(p,{modelValue:l.value.quantity,"onUpdate:modelValue":a[8]||(a[8]=n=>l.value.quantity=n),min:0},null,8,["modelValue"])]),_:1}),e(u,null,{default:t(()=>[e(C,{type:"primary",onClick:k},{default:t(()=>[g("提交")]),_:1}),e(C,{onClick:v},{default:t(()=>[g("关闭")]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])}}},L=E(K,[["__scopeId","data-v-cbdd8bb5"]]),W={__name:"index",setup(c){const i=U({searchForm:{},pageData:[],page:{current:1,size:10},total:0}),m=()=>{z({...i.page,...i.searchForm}).then(o=>{i.pageData=o.data.records,i.total=o.data.total})};m();const _=o=>{i.page.current=o,m()},l=V(),x=o=>{l.value.init(o)},w=o=>{o&&m()},y=V(!0);let v=[];const b=o=>{const a=[];o?a.push(o):a.push(...v),j.confirm("确认删除该记录吗？","警告",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(()=>{A(a).then(s=>{I.success("删除成功"),m()})})},k=o=>{y.value=o.length===0,v=o.map(a=>a.id)};return(o,a)=>{const s=r("el-input"),u=r("el-form-item"),p=r("el-button"),C=r("el-form"),d=r("el-table-column"),h=r("el-table"),n=r("el-pagination");return B(),N("div",null,[e(C,{"label-width":"auto",inline:!0},{default:t(()=>[e(u,null,{default:t(()=>[e(s,{modelValue:i.searchForm.hotelTitle,"onUpdate:modelValue":a[0]||(a[0]=f=>i.searchForm.hotelTitle=f),placeholder:"酒店名称"},null,8,["modelValue"])]),_:1}),e(u,null,{default:t(()=>[e(p,{onClick:m},{default:t(()=>[g("搜索")]),_:1})]),_:1}),e(u,null,{default:t(()=>[e(p,{type:"primary",onClick:a[1]||(a[1]=f=>x(null))},{default:t(()=>[g("新增")]),_:1})]),_:1}),e(u,null,{default:t(()=>[e(p,{type:"danger",onClick:a[2]||(a[2]=f=>b(null)),disabled:y.value},{default:t(()=>[g("批量删除")]),_:1},8,["disabled"])]),_:1})]),_:1}),e(h,{data:i.pageData,border:"",style:{width:"100%"},onSelectionChange:k},{default:t(()=>[e(d,{type:"selection",width:"55"}),e(d,{prop:"hotelTitle",label:"所属酒店"}),e(d,{prop:"name",label:"房间名称"}),e(d,{prop:"price",label:"价格"}),e(d,{prop:"area",label:"面积"}),e(d,{prop:"bed",label:"床位"}),e(d,{prop:"quantity",label:"剩余数量"}),e(d,{label:"操作"},{default:t(f=>[e(p,{type:"text",onClick:S=>x(f.row.id)},{default:t(()=>[g("编辑")]),_:2},1032,["onClick"]),e(p,{type:"text",onClick:S=>b(f.row.id)},{default:t(()=>[g("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),e(n,{style:{"margin-top":"16px"},background:"",layout:"total, prev, pager, next","page-size":i.page.size,total:i.total,onCurrentChange:_},null,8,["page-size","total"]),e(L,{ref_key:"editRef",ref:l,onHandleClose:w},null,512)])}}};export{W as default};
