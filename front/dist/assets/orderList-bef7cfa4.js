import{b as I,L as M,a as E,P as $}from"./order-b00400c5.js";import{_ as z,C as O,D as F,g as P,E as r,f as s,e as l,M as A,N as H,a as v,l as _,w as o,d as f,O as K,o as n,i as u,af as U,z as i,ad as j,k as q,H as G,ae as k,F as J,h as p,A as Q,B as R,L as W,K as C}from"./index-98ff7959.js";import"./user-194456a1.js";const S=m=>(Q("data-v-3a6a3036"),m=m(),R(),m),X={class:"order-list-container"},Y=S(()=>s("div",{class:"page-header"},[s("h2",{class:"page-title"},"我的订单"),s("p",{class:"page-desc"},"查看您的所有酒店预订记录")],-1)),Z={class:"order-filter"},tt={class:"order-list"},st={class:"order-header"},et={class:"order-id"},at={class:"order-content"},lt={class:"hotel-info"},ot={class:"hotel-name"},nt={class:"room-type"},it=S(()=>s("span",{class:"label"},"房型：",-1)),ct={class:"order-details"},dt={class:"detail-item"},ut={class:"detail-item"},rt={class:"detail-item"},_t={class:"detail-item price"},pt={class:"order-actions"},mt={key:1,class:"load-more"},ht={key:2,class:"no-more"},ft={__name:"orderList",setup(m){const t=O({dicts:[],orders:[],total:0,status:"",loading:!1,page:{current:1,size:10},loadBtnStatus:!1}),g=()=>{t.loading=!0,M({status:t.status,...t.page}).then(e=>{t.orders.push(...e.data.records),t.total=e.data.total,t.total===t.orders.length&&(t.loadBtnStatus=!0)}).finally(()=>{t.loading=!1})},B=()=>{I().then(e=>{t.dicts=[{label:"全部",value:""},...e.data.map(c=>({label:c.value,value:c.key}))]}),g()},b=e=>{W.confirm("确认取消该订单吗?","提示",{confirmButtonText:"确认",cancelButtonText:"关闭",type:"warning"}).then(()=>{t.loading=!0,E(e.id).then(c=>{C.success("订单取消成功"),e.status=5,e.statusStr="已取消"}).finally(()=>{t.loading=!1})})},x=e=>{t.loading=!0,$(e.id).then(c=>{C.success("支付成功"),e.status=2,e.statusStr="待入住"}).finally(()=>{t.loading=!1})},T=e=>{t.total=0,t.page.current=1,t.orders=[],t.loadBtnStatus=!1,g()},L=()=>{t.page.current++,g()},N=e=>{switch(Number(e)){case 1:return"status-pending";case 2:return"status-upcoming";case 3:return"status-active";case 4:return"status-completed";case 5:return"status-cancelled";default:return""}};return F(()=>{B()}),(e,c)=>{const V=f("el-segmented"),d=f("el-icon"),h=f("el-button"),w=f("el-empty"),D=K("loading");return P((n(),r("div",X,[Y,s("div",Z,[l(V,{modelValue:t.status,"onUpdate:modelValue":c[0]||(c[0]=a=>t.status=a),options:t.dicts,onChange:T,class:"status-filter"},null,8,["modelValue","options"])]),s("div",tt,[(n(!0),r(A,null,H(t.orders,a=>(n(),r("div",{class:"order-card",key:a.id},[s("div",st,[s("div",et,[l(d,null,{default:o(()=>[l(u(U))]),_:1}),s("span",null,"订单号："+i(a.sn),1)]),s("div",{class:j(["order-status",N(a.status)])},i(a.statusStr),3)]),s("div",at,[s("div",lt,[s("div",ot,[l(d,null,{default:o(()=>[l(u(q))]),_:1}),s("span",null,i(a.hotelTitle),1)]),s("div",nt,[it,s("span",null,i(a.roomTypeName),1)])]),s("div",ct,[s("div",dt,[l(d,null,{default:o(()=>[l(u(G))]),_:1}),s("span",null,"预订时间："+i(a.bookTime),1)]),s("div",ut,[l(d,null,{default:o(()=>[l(u(k))]),_:1}),s("span",null,"入住时间："+i(a.bookCheckInTime),1)]),s("div",rt,[l(d,null,{default:o(()=>[l(u(k))]),_:1}),s("span",null,"退房时间："+i(a.bookCheckOutTime),1)]),s("div",_t,[l(d,null,{default:o(()=>[l(u(J))]),_:1}),s("span",null,[p("订单金额："),s("strong",null,"¥ "+i(a.price),1)])])])]),s("div",pt,[l(h,{onClick:y=>e.$router.push("/order-detail/"+a.id),plain:""},{default:o(()=>[p(" 查看详情 ")]),_:2},1032,["onClick"]),a.status===1?(n(),v(h,{key:0,type:"danger",onClick:y=>b(a),plain:""},{default:o(()=>[p(" 取消订单 ")]),_:2},1032,["onClick"])):_("",!0),a.status===1?(n(),v(h,{key:1,type:"primary",onClick:y=>x(a)},{default:o(()=>[p(" 立即支付 ")]),_:2},1032,["onClick"])):_("",!0)])]))),128)),t.orders.length===0&&!t.loading?(n(),v(w,{key:0,description:"暂无订单记录",class:"empty-state"})):_("",!0),t.total>0&&!t.loadBtnStatus?(n(),r("div",mt,[l(h,{onClick:L,loading:t.loading,class:"load-more-btn"},{default:o(()=>[p(" 加载更多 ")]),_:1},8,["loading"])])):_("",!0),t.loadBtnStatus&&t.orders.length>0?(n(),r("div",ht," 没有更多订单了 ")):_("",!0)])])),[[D,t.loading]])}}},kt=z(ft,[["__scopeId","data-v-3a6a3036"]]);export{kt as default};
